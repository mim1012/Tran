<Window x:Class="Tran.Desktop.DocumentDetailWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="거래명세표 상세" Height="600" Width="900"
        WindowStartupLocation="CenterOwner"
        Background="White">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 상태 배너 (상태별로 보임/숨김) -->
        <Border Grid.Row="0" Background="{Binding StatePillBackground}" Padding="15"
                Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal">
                <Border Background="{Binding StatePillBackground}"
                       CornerRadius="6"
                       Padding="10,5"
                       Margin="0,0,15,0">
                    <TextBlock Text="{Binding StateDisplayText}"
                             Foreground="{Binding StatePillForeground}"
                             FontSize="14"
                             FontWeight="Bold"/>
                </Border>
                <TextBlock Text="이 문서의 현재 상태입니다"
                         Foreground="{Binding StatePillForeground}"
                         VerticalAlignment="Center"
                         FontSize="13"/>
            </StackPanel>
        </Border>

        <!-- 문서 정보 섹션 -->
        <Border Grid.Row="1" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="20" Background="#FAFAFA">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- 문서번호 -->
                <TextBlock Grid.Row="0" Grid.Column="0" Text="문서번호"
                          FontWeight="Bold" Foreground="#666" Margin="0,0,0,5"/>
                <TextBlock Grid.Row="1" Grid.Column="0" Text="{Binding DocumentId, Mode=OneWay}"
                          FontSize="16" Margin="0,0,0,15"/>

                <!-- 버전 -->
                <TextBlock Grid.Row="0" Grid.Column="1" Text="버전"
                          FontWeight="Bold" Foreground="#666" Margin="0,0,0,5"/>
                <TextBlock Grid.Row="1" Grid.Column="1" FontSize="16" Margin="0,0,0,15">
                    <Run Text="v"/>
                    <Run Text="{Binding VersionNumber, Mode=OneWay}"/>
                </TextBlock>

                <!-- 발신 거래처 -->
                <TextBlock Grid.Row="2" Grid.Column="0" Text="발신 거래처"
                          FontWeight="Bold" Foreground="#666" Margin="0,0,0,5"/>
                <TextBlock Grid.Row="3" Grid.Column="0" Text="{Binding FromCompanyId, Mode=OneWay}"
                          FontSize="16" Margin="0,0,0,15"/>

                <!-- 수신 거래처 -->
                <TextBlock Grid.Row="2" Grid.Column="1" Text="수신 거래처"
                          FontWeight="Bold" Foreground="#666" Margin="0,0,0,5"/>
                <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding ToCompanyId, Mode=OneWay}"
                          FontSize="16" Margin="0,0,0,15"/>
            </Grid>
        </Border>

        <!-- 중앙 영역 (품목 목록) -->
        <Border Grid.Row="2" Padding="20">
            <StackPanel>
                <TextBlock Text="품목 내역" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>

                <!-- 품목 DataGrid -->
                <DataGrid ItemsSource="{Binding Items}"
                         AutoGenerateColumns="False"
                         IsReadOnly="True"
                         CanUserAddRows="False"
                         CanUserDeleteRows="False"
                         RowHeaderWidth="0"
                         GridLinesVisibility="Horizontal"
                         BorderBrush="#E0E0E0"
                         BorderThickness="1"
                         HeadersVisibility="Column"
                         Background="White">
                    <DataGrid.ColumnHeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="Background" Value="#F5F5F5"/>
                            <Setter Property="Foreground" Value="#333"/>
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="Padding" Value="12,10"/>
                            <Setter Property="BorderBrush" Value="#E0E0E0"/>
                            <Setter Property="BorderThickness" Value="0,0,1,1"/>
                        </Style>
                    </DataGrid.ColumnHeaderStyle>
                    <DataGrid.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="Padding" Value="12,8"/>
                            <Setter Property="BorderBrush" Value="#F0F0F0"/>
                            <Setter Property="BorderThickness" Value="0,0,1,0"/>
                        </Style>
                    </DataGrid.CellStyle>

                    <DataGrid.Columns>
                        <!-- 품명 -->
                        <DataGridTextColumn Header="품명" Binding="{Binding ItemName}" Width="2*"/>

                        <!-- 옵션/비고 -->
                        <DataGridTextColumn Header="옵션/비고" Binding="{Binding OptionText}" Width="1.5*"/>

                        <!-- 수량 -->
                        <DataGridTextColumn Header="수량" Binding="{Binding Quantity}" Width="*">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="TextAlignment" Value="Right"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <!-- 단가 -->
                        <DataGridTextColumn Header="단가" Binding="{Binding UnitPrice, StringFormat={}{0:N0}}" Width="1.2*">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="TextAlignment" Value="Right"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <!-- 금액 -->
                        <DataGridTextColumn Header="금액" Binding="{Binding LineAmount, StringFormat={}{0:N0}}" Width="1.5*">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="TextAlignment" Value="Right"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                    <Setter Property="Foreground" Value="#1E5EFF"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <!-- 규격 -->
                        <DataGridTextColumn Header="규격" Binding="{Binding SpecSummary}" Width="100">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="TextAlignment" Value="Center"/>
                                    <Setter Property="ToolTip" Value="{Binding SpecTooltip}"/>
                                    <Setter Property="Foreground" Value="#9B59B6"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                    </DataGrid.Columns>
                </DataGrid>

                <!-- 합계 금액 -->
                <Border Background="#F0F0F0" Padding="15" Margin="0,20,0,0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="총 금액"
                                 FontSize="16" FontWeight="Bold"
                                 VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1"
                                 FontSize="20" FontWeight="Bold" Foreground="#1E5EFF">
                            <Run Text="{Binding TotalAmount, StringFormat={}{0:N0}, Mode=OneWay}"/>
                            <Run Text="원"/>
                        </TextBlock>
                    </Grid>
                </Border>
            </StackPanel>
        </Border>

        <!-- 하단 버튼 영역 -->
        <Border Grid.Row="3" Background="#F5F5F5" Padding="20" BorderBrush="#E0E0E0" BorderThickness="0,1,0,0">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <!-- 전송 버튼 (Draft만) -->
                <Button Content="전송"
                       Command="{Binding SendCommand}"
                       Visibility="{Binding CanSend, Converter={StaticResource BoolToVisibilityConverter}}"
                       Background="#3498DB" Foreground="White"
                       Padding="20,10" Margin="0,0,10,0"
                       BorderThickness="0"
                       FontWeight="Bold"
                       Cursor="Hand"/>

                <!-- 확정 버튼 (Received만) -->
                <Button Content="확정"
                       Command="{Binding ConfirmCommand}"
                       Visibility="{Binding CanConfirm, Converter={StaticResource BoolToVisibilityConverter}}"
                       Background="#27AE60" Foreground="White"
                       Padding="20,10" Margin="0,0,10,0"
                       BorderThickness="0"
                       FontWeight="Bold"
                       Cursor="Hand"/>

                <!-- 수정 요청 버튼 (Received만) -->
                <Button Content="수정 요청"
                       Command="{Binding RequestRevisionCommand}"
                       Visibility="{Binding CanRequestRevision, Converter={StaticResource BoolToVisibilityConverter}}"
                       Background="#E67700" Foreground="White"
                       Padding="20,10" Margin="0,0,10,0"
                       BorderThickness="0"
                       FontWeight="Bold"
                       Cursor="Hand"/>

                <!-- 닫기 버튼 (항상 표시) -->
                <Button Content="닫기"
                       Command="{Binding CloseCommand}"
                       CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                       Background="#95A5A6" Foreground="White"
                       Padding="20,10"
                       BorderThickness="0"
                       Cursor="Hand"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
